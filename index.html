<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>QCM Culture Incendie – Fin de formation</title>

<style>
body{margin:0;font-family:system-ui;background:#0f1115;color:#111}
.container{max-width:800px;margin:auto;padding:20px}
.card{background:#fff;border-radius:16px;padding:20px;margin-bottom:15px}
h1{color:#fff;text-align:center}
label{font-weight:700;display:block;margin-top:10px}
input,select,textarea{width:100%;padding:12px;margin-top:5px}
button{width:100%;padding:14px;margin-top:15px;font-weight:700}
.danger{color:#c62828;font-weight:700}
.good{color:#2e7d32;font-weight:700}
.bad{color:#c62828;font-weight:700}
</style>
</head>

<body>
<div class="container">
<h1>QCM Culture Incendie</h1>

<!-- START -->
<div id="startCard" class="card">
<label>Service *</label>
<select id="service">
  <option value="">— Choisir —</option>
  <option>Escale</option>
  <option>ASCT</option>
  <option>Vente / Accueil</option>
  <option>Sûreté</option>
</select>

<label>Nom *</label>
<input id="nom">
<label>Prénom *</label>
<input id="prenom">

<p id="startError" class="danger" style="display:none">
Nom, prénom et service sont obligatoires.
</p>

<button id="startBtn">Démarrer</button>
</div>

<!-- QUIZ -->
<div id="quizCard" class="card" style="display:none">
<p><strong>Question <span id="qIndex"></span>/12</strong></p>
<div id="question"></div>
<div id="options"></div>
<button id="nextBtn" disabled>Valider & Suivant</button>
</div>

<!-- SEND -->
<div id="sendCard" class="card" style="display:none">
<label>Remarque (optionnel)</label>
<textarea id="commentaire"></textarea>
<button id="sendBtn">Envoyer mes réponses</button>
</div>

<!-- CORRECTION -->
<div id="correctionCard" class="card" style="display:none">
<h2>Correction</h2>
<p id="score"></p>
<div id="details"></div>
</div>
</div>

<script>
const QUESTIONS=[
{q:"Première action sur alarme ?",o:["Zone","Arrêter SDI","Réarmer","Pompiers"],c:1},
{q:"Lecture prioritaire ?",o:["Date","Zonage","Historique","Niveau"],c:1},
{q:"Voyant DM ?",o:["Vert","Rouge clignotant","Bleu","Orange"],c:1},
{q:"Feu avéré ?",o:["Attendre","Réarmer","Procédures urgence","Couper elec"],c:2},
{q:"Réarmer DM si ?",o:["Toujours","Fausse alarme","Avant doute","Jamais"],c:1},
{q:"Niveau 2 SMSI ?",o:["Évacuer","Neutraliser","Accès commandes","Stop SDI"],c:2},
{q:"Rôle SDI ?",o:["Agir","Détecter","Évacuer","Commander"],c:1},
{q:"Rôle SMSI ?",o:["Détecter","Informer","Piloter DAS","Éteindre"],c:2},
{q:"SSI réarmé si ?",o:["Alarme stop","Doute","DAS repos","CEV présent"],c:2},
{q:"Priorité CEV ?",o:["Service","Matériel","Personnes","Image"],c:2},
{q:"Rôle avec secours ?",o:["Commander","Intervenir","Informer","Éteindre"],c:2},
{q:"Levée de doute ?",o:["Seul","Risque","Sans danger","En courant"],c:2}
];

let idx=0,answers=[];

const $=id=>document.getElementById(id);

$("startBtn").onclick=()=>{
  if(!$("service").value || !$("nom").value || !$("prenom").value){
    $("startError").style.display="block";
    return;
  }
  $("startError").style.display="none";
  $("startCard").style.display="none";
  $("quizCard").style.display="block";
  render();
};

function render(){
  $("qIndex").textContent=idx+1;
  $("question").textContent=QUESTIONS[idx].q;
  $("options").innerHTML="";
  QUESTIONS[idx].o.forEach((t,i)=>{
    const l=document.createElement("label");
    l.innerHTML=`<input type="radio" name="opt" value="${i}"> ${t}`;
    $("options").appendChild(l);
  });
  $("nextBtn").disabled=true;
  $("options").onchange=()=>$("nextBtn").disabled=false;
}

$("nextBtn").onclick=()=>{
  const sel=[...document.getElementsByName("opt")].find(r=>r.checked);
  answers.push(sel?+sel.value:null);
  idx++;
  if(idx===QUESTIONS.length){
    $("quizCard").style.display="none";
    $("sendCard").style.display="block";
  } else render();
};

$("sendBtn").onclick=()=>{
  showCorrection(); // AFFICHAGE GARANTI
};

function showCorrection(){
  $("sendCard").style.display="none";
  $("correctionCard").style.display="block";
  let score=0;
  $("details").innerHTML="";
  QUESTIONS.forEach((q,i)=>{
    const ok=answers[i]===q.c;
    if(ok) score++;
    const div=document.createElement("div");
    div.innerHTML=`
      <p>
      <strong>Q${i+1}</strong> – ${q.q}<br>
      <span class="${ok?"good":"bad"}">Ta réponse : ${q.o[answers[i]]||"Aucune"}</span><br>
      <span class="good">Bonne réponse : ${q.o[q.c]}</span>
      </p>`;
    $("details").appendChild(div);
  });
  $("score").innerHTML=`<strong>Score : ${score}/12</strong>`;
}
</script>
</body>
</html>
